classes:
  - splunk 
  - rsyslog::server

rsyslog::server::enable_tcp: true
rsyslog::server::server_dir: '/opt/syslog'
rsyslog::server::port      : 514

splunk::httpport   : 8000
splunk::kvstoreport: 8191
splunk::inputport  : 9997

rsyslog::client::port                     : '5140'

firewall_rules_specific:
  allow_slunk:
    name: "200 Allow splunk"
    chain: INPUT
    proto: tcp
    dport: 8000
    action: accept
  allow_syslog:
    name: "200 Allow splunk syslog"
    chain: INPUT
    proto: tcp
    dport: 514
    action: accept
  allow_splunk_log:
    name: "200 Allow syslog-redirect"
    chain: INPUT
    proto: tcp
    dport: 5140
    action: accept
  redirect_syslog:
    name   : "200 Redirect rsyslog"
    chain  : PREROUTING
    table  : nat
    dport  : 514
    toports: 5140
    proto  : tcp
    jump   : REDIRECT    
